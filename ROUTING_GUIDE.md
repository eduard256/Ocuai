# Ocuai Routing Guide

## ‚úÖ –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **üîÑ –ù–∞—Å—Ç–æ—è—â–∏–µ URL –ø—É—Ç–∏** - –±–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö hash-—Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
2. **üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–µ—Å—Å–∏–∏** - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
3. **‚ö° –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
4. **üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏** - —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `/auth` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É
- `/reg` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

### –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- `/panel` - –ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (dashboard)
- `/cam` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä–∞–º–∏
- `/noti` - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—ã—Ç–∏–π –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `/set` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã

## üöÄ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **–í—Ä–µ–º—è**: –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
- **–î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**: –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
- **Dashboard**: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- **WebSocket**: –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- Stores –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∂–∏–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–∞–Ω–µ–ª–∏

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### Frontend (Svelte)

#### App.svelte - –û—Å–Ω–æ–≤–Ω–æ–π —Ä–æ—É—Ç–µ—Ä
```javascript
// –ù–∞—Å—Ç–æ—è—â–∏–µ URL –ø—É—Ç–∏
function getCurrentRoute() {
  return window.location.pathname
}

// –ò—Å—Ç–æ—Ä–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
window.addEventListener('popstate', handlePopState)

// –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
dataRefreshInterval = setInterval(refreshData, 15000)
```

#### –£–ª—É—á—à–µ–Ω–Ω—ã–µ Stores
```javascript
// –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
systemStats.update(stats => ({
  ...stats,
  last_updated: Date.now()
}))

// –†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Å—á–µ—Ç—ã
export const camerasOnline = derived(cameras, $cameras => 
  $cameras.filter(camera => camera.status === 'online').length
)
```

### Backend (Go)

#### –°—Ç–∞–±–∏–ª—å–Ω—ã–µ —Å–µ—Å—Å–∏–∏
```go
// –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á —Å–µ—Å—Å–∏–∏ –≤–º–µ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ
secretKey = "ocuai-session-key-2024-stable-key-for-development-and-production-use"

// –£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π
session := sessions.NewSession(s.store, SessionName)
session.IsNew = true
```

#### SPA Support
```go
// –í—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç index.html –¥–ª—è SPA
r.Get("/*", func(w http.ResponseWriter, r *http.Request) {
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º index.html
    file, err := webFS.Open("index.html")
    // ...
})
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:
‚úÖ **–ù–∞—Å—Ç–æ—è—â–∏–µ URL –ø—É—Ç–∏** - localhost:3000/panel, localhost:3000/cam –∏ —Ç.–¥.  
‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω—ã–π –≤—Ö–æ–¥** - —Å–µ—Å—Å–∏–∏ –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏** - –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ ‚Üí /panel  
‚úÖ **–ñ–∏–≤–æ–µ –≤—Ä–µ–º—è** - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É  
‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ** - –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
‚úÖ **WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏  
‚úÖ **–ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–π –º–∞—Ä—à—Ä—É—Ç  

### –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- ‚è±Ô∏è **–í—Ä–µ–º—è –ø–∞–Ω–µ–ª–∏**: 1 —Å–µ–∫—É–Ω–¥–∞
- üìä **–î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**: 15 —Å–µ–∫—É–Ω–¥  
- üìà **Dashboard –¥–∞–Ω–Ω—ã–µ**: 30 —Å–µ–∫—É–Ω–¥
- üîó **WebSocket**: –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

## –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏

### –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
2. –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ‚Üí `/reg`
3. –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Üí `/auth`
4. –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Üí `/panel` (–∏–ª–∏ —Ç–µ–∫—É—â–∏–π –ø—É—Ç—å –µ—Å–ª–∏ –≤–∞–ª–∏–¥–Ω—ã–π)

### –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ `/panel`

### –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ `/auth` –¥–ª—è –≤—Ö–æ–¥–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 404 —Å –∫–Ω–æ–ø–∫–æ–π –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –≥–ª–∞–≤–Ω—É—é

## –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### Dashboard (/panel)
- –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥  
- WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∂–∏–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤—Ä–µ–º–µ–Ω–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- `Dashboard.svelte` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –≤—Ä–µ–º—è
- WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–º–µ—Ä
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### Vite (Frontend)
```javascript
server: {
  proxy: {
    '/api': 'http://localhost:8080',
    '/ws': 'ws://localhost:8080'
  }
}
```

### Go —Å–µ—Ä–≤–µ—Ä (Backend)
- –ü–æ—Ä—Ç: 8080
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- SPA fallback –¥–ª—è –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∫—Ä–æ–º–µ API

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### URL —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000/auth - –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
2. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000/panel - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –Ω–∞ /auth –µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
3. –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ http://localhost:3000/cam –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–∞–º–µ—Ä
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É - URL –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è —Ç–µ–º –∂–µ

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
4. –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–∞–Ω–µ–ª–∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É** ‚≠ê
6. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** ‚≠ê

## –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ –±—Ä–∞—É–∑–µ—Ä–∞
```javascript
console.log('Route updated to:', currentRoute)
console.log('Navigating to:', path)
console.log('Auth state:', $authState)
console.log('Dashboard: Refreshing data...')
```

### –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
```
Session store configured: MaxAge=604800, HttpOnly=false, Secure=false
Login attempt: username='admin', password_length=8
Session saved successfully for user 'admin'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- DevTools ‚Üí Application ‚Üí Cookies ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Å—Å–∏–æ–Ω–Ω—É—é –∫—É–∫—É
- DevTools ‚Üí Console ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏  
- DevTools ‚Üí Network ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å API –∑–∞–ø—Ä–æ—Å—ã
- **–í—Ä–µ–º—è –Ω–∞ –ø–∞–Ω–µ–ª–∏ –¥–æ–ª–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É** ‚≠ê

## üéâ –í—Å–µ –≥–æ—Ç–æ–≤–æ!

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å:
- ‚úÖ –ù–∞—Å—Ç–æ—è—â–∏–º–∏ URL –ø—É—Ç—è–º–∏
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ —Å–µ—Å—Å–∏—è–º–∏
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è–º–∏

**–ü—Ä–æ–±–ª–µ–º—ã —Å "—Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π" –ø–∞–Ω–µ–ª—å—é –∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–µ–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω—ã!**